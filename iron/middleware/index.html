<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="utf-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <meta name="generator" content="rustdoc">
    <meta name="description" content="API documentation for the Rust `middleware` mod in crate `iron`.">
    <meta name="keywords" content="rust, rustlang, rust-lang, middleware">

    <title>iron::middleware - Rust</title>

    <link rel="stylesheet" type="text/css" href="../../main.css">

    <link rel="shortcut icon" href="https://avatars0.githubusercontent.com/u/7853871?s=256">
    
</head>
<body class="rustdoc">
    <!--[if lte IE 8]>
    <div class="warning">
        This old browser is unsupported and will most likely display funky
        things.
    </div>
    <![endif]-->

    

    <section class="sidebar">
        <a href='../../iron/index.html'><img src='https://avatars0.githubusercontent.com/u/7853871?s=128' alt='' width='100'></a>
        <p class='location'><a href='../index.html'>iron</a></p><div class='block mod'><h2>Modules</h2><a class='mod ' href='../error/index.html' title='Iron&#39;s error type and associated utilities.'>error</a><a class='mod ' href='../headers/index.html' title='Headers container, and common header fields.'>headers</a><a class='mod ' href='../method/index.html' title='HTTP Methods'>method</a><a class='mod current' href='../middleware/index.html' title='Iron&#39;s Middleware and Handler System'>middleware</a><a class='mod ' href='../mime/index.html' title=''>mime</a><a class='mod ' href='../modifier/index.html' title='Re-exports from the Modifier crate. Overloadable modification through both owned and mutable references to a type with minimal code duplication. '>modifier</a><a class='mod ' href='../modifiers/index.html' title='Defines a series of convenience modifiers for editing Responses'>modifiers</a><a class='mod ' href='../prelude/index.html' title='A module meant to be glob imported when using Iron, for instance:'>prelude</a><a class='mod ' href='../request/index.html' title='Iron&#39;s HTTP Request representation and associated methods.'>request</a><a class='mod ' href='../response/index.html' title='Iron&#39;s HTTP Response representation and associated methods.'>response</a><a class='mod ' href='../status/index.html' title='Status Codes'>status</a><a class='mod ' href='../typemap/index.html' title='Re-exports from the TypeMap crate.'>typemap</a></div><div class='block struct'><h2>Structs</h2><a class='struct ' href='../struct.Headers.html' title='A map of header fields on requests and responses.'>Headers</a><a class='struct ' href='../struct.Iron.html' title='The primary entrance point to `Iron`, a `struct` to instantiate a new server.'>Iron</a><a class='struct ' href='../struct.TypeMap.html' title='A map keyed by types.'>TypeMap</a><a class='struct ' href='../struct.Url.html' title='HTTP/HTTPS URL type for Iron.'>Url</a></div><div class='block trait'><h2>Traits</h2><a class='trait ' href='../trait.Error.html' title='An extension to std::error::Error which provides dynamic downcasting of errors for use in highly generic contexts.'>Error</a><a class='trait ' href='../trait.Plugin.html' title='An interface for plugins that cache values between calls.'>Plugin</a></div>
    </section>

    <nav class="sub">
        <form class="search-form js-only">
            <div class="search-container">
                <input class="search-input" name="search"
                       autocomplete="off"
                       placeholder="Click or press 'S' to search, '?' for more options..."
                       type="search">
            </div>
        </form>
    </nav>

    <section id='main' class="content mod">
<h1 class='fqn'><span class='in-band'>Module <a href='../index.html'>iron</a>::<wbr><a class='mod' href=''>middleware</a><wbr></span><span class='out-of-band'><span id='render-detail'>
            <a id="collapse-all" href="#">[-]
            </a>&nbsp;<a id="expand-all" href="#">[+]</a>
        </span><a id='src-687' href='../../src/iron/middleware/mod.rs.html#1-340'>[src]</a></span></h1>
<div class='docblock'><p>Iron&#39;s Middleware and Handler System</p>

<p>Iron&#39;s Middleware system is best modeled with a diagram.</p>

<pre><code class="language-plain">[b] = BeforeMiddleware
[a] = AfterMiddleware
[[h]] = AroundMiddleware
[h] = Handler
</code></pre>

<p>With no errors, the flow looks like:</p>

<pre><code class="language-plain">[b] -&gt; [b] -&gt; [b] -&gt; [[[[h]]]] -&gt; [a] -&gt; [a] -&gt; [a] -&gt; [a]
</code></pre>

<p>A request first travels through all BeforeMiddleware, then a Response is generated
by the Handler, which can be an arbitrary nesting of AroundMiddleware, then all
AfterMiddleware are called with both the Request and Response. After all AfterMiddleware
have been fired, the response is written back to the client.</p>

<p>Iron&#39;s error handling system is pragmatic and focuses on tracking two pieces
of information for error receivers (other middleware):</p>

<ul>
<li>The cause of the error</li>
<li>The result (what to do about) the error.</li>
</ul>

<p>The cause of the error is represented simply by the error itself, and the result
of the error, representing the action to take in response to the error, is a complete
Response, which will be sent at the end of the error flow.</p>

<p>When an error is thrown in Iron by any middleware or handler returning an <code>Err</code>
variant with an <code>IronError</code>, the flow of the Request switches to the error flow,
which proceeds to just call the <code>catch</code> method of middleware and sidesteps the
<code>Handler</code> entirely, since there is already a Response in the error.</p>

<p>A Request can exit the error flow by returning an Ok from any of the catch methods.
This resumes the flow at the middleware immediately following the middleware which
handled the error. It is impossible to &quot;go back&quot; to an earlier middleware that was
skipped.</p>

<p>Generally speaking, returning a 5XX error code means that the error flow should be
entered by raising an explicit error. Dealing with 4XX errors is trickier, since
the server may not want to recognize an error that is entirely the clients fault;
handling of 4XX error codes is up to to each application and middleware author.</p>

<p>Middleware authors should be cognizant that their middleware may be skipped during
the error flow. Anything that <em>must</em> be done to each Request or Response should
be run during both the normal and error flow by implementing the <code>catch</code> method to
also do the necessary action.</p>
</div><h2 id='structs' class='section-header'><a href="#structs">Structs</a></h2>
<table>
                    <tr>
                        <td><a class='stability Unmarked' title='No stability level'></a><a class='struct' href='struct.Chain.html'
                               title='iron::middleware::Chain'>Chain</a></td>
                        <td class='docblock short'><p>The middleware chain used in Iron.</p>
</td>
                    </tr>
                </table><h2 id='traits' class='section-header'><a href="#traits">Traits</a></h2>
<table>
                    <tr>
                        <td><a class='stability Unmarked' title='No stability level'></a><a class='trait' href='trait.AfterMiddleware.html'
                               title='iron::middleware::AfterMiddleware'>AfterMiddleware</a></td>
                        <td class='docblock short'><p><code>AfterMiddleware</code> are fired after a <code>Handler</code> is called inside of a Chain.</p>
</td>
                    </tr>
                
                    <tr>
                        <td><a class='stability Unmarked' title='No stability level'></a><a class='trait' href='trait.AroundMiddleware.html'
                               title='iron::middleware::AroundMiddleware'>AroundMiddleware</a></td>
                        <td class='docblock short'><p>AroundMiddleware are used to wrap and replace the <code>Handler</code> in a <code>Chain</code>.</p>
</td>
                    </tr>
                
                    <tr>
                        <td><a class='stability Unmarked' title='No stability level'></a><a class='trait' href='trait.BeforeMiddleware.html'
                               title='iron::middleware::BeforeMiddleware'>BeforeMiddleware</a></td>
                        <td class='docblock short'><p><code>BeforeMiddleware</code> are fired before a <code>Handler</code> is called inside of a Chain.</p>
</td>
                    </tr>
                
                    <tr>
                        <td><a class='stability Unmarked' title='No stability level'></a><a class='trait' href='trait.Handler.html'
                               title='iron::middleware::Handler'>Handler</a></td>
                        <td class='docblock short'><p><code>Handler</code>s are responsible for handling requests by creating Responses from Requests.</p>
</td>
                    </tr>
                </table></section>
    <section id='search' class="content hidden"></section>

    <section class="footer"></section>

    <div id="help" class="hidden">
        <div class="shortcuts">
            <h1>Keyboard shortcuts</h1>
            <dl>
                <dt>?</dt>
                <dd>Show this help dialog</dd>
                <dt>S</dt>
                <dd>Focus the search field</dd>
                <dt>&larrb;</dt>
                <dd>Move up in search results</dd>
                <dt>&rarrb;</dt>
                <dd>Move down in search results</dd>
                <dt>&#9166;</dt>
                <dd>Go to active search result</dd>
            </dl>
        </div>
        <div class="infos">
            <h1>Search tricks</h1>
            <p>
                Prefix searches with a type followed by a colon (e.g.
                <code>fn:</code>) to restrict the search to a given type.
            </p>
            <p>
                Accepted types are: <code>fn</code>, <code>mod</code>,
                <code>struct</code>, <code>enum</code>,
                <code>trait</code>, <code>typedef</code> (or
                <code>tdef</code>).
            </p>
        </div>
    </div>

    

    <script>
        window.rootPath = "../../";
        window.currentCrate = "iron";
        window.playgroundUrl = "";
    </script>
    <script src="../../jquery.js"></script>
    <script src="../../main.js"></script>
    
    <script async src="../../search-index.js"></script>
</body>
</html>